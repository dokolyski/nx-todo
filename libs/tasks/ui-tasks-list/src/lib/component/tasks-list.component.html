<div class='task-list__header'>
  <ng-content></ng-content>
</div>
<mat-divider class='task-list__divider'></mat-divider>
<div class='task-list__content'>
  <ng-container *ngIf='tasks.length > 0; else noTasks'>
    <mat-accordion cdkDropList (cdkDropListDropped)='dropTask($event)'
                   [hideToggle]='true'>
      <mat-expansion-panel
        cdkDrag [cdkDragData]='task'
        class='task-list__content__item'
        *ngFor='let task of tasks'
      >
        <mat-expansion-panel-header>
          <mat-panel-title>
            {{ task.name }}
          </mat-panel-title>
          <mat-panel-description *ngIf='task.dueDate != null'>
            {{ task.dueDate.toLocaleString() }}
          </mat-panel-description>
          <mat-checkbox
            [checked]='type === "done"'
            (click)='$event.stopImmediatePropagation()'
            (change)='completionChange(task)'
          ></mat-checkbox>
        </mat-expansion-panel-header>
        <div class='task-list__content__item__expandable'>
          <button
            *ngIf='type === "todo"'
            (click)='completionChange(task)'
            mat-raised-button
            color='primary'
          >
            Mark as completed
          </button>
          <button
            *ngIf='type === "todo"'
            (click)='editTask(task)'
            mat-raised-button
            color='accent'
          >
            Edit
          </button>
          <button (click)='deleteTask(task)' mat-raised-button color='warn'>
            Delete
          </button>
        </div>
      </mat-expansion-panel>
    </mat-accordion>
    <mat-paginator
      class='task-list-container__task-list'
      [length]='pagination.tasksNumber'
      [pageSize]='pagination.limit'
      [pageSizeOptions]='[5, 10, 15]'
      (page)='
        changePage.emit({ event: $event, tasksNumber: pagination.tasksNumber, type: type })
      '
    >
    </mat-paginator>
  </ng-container>
  <ng-template #noTasks>
    <div *ngIf='!error; else errorMessage' cdkDropList
         (cdkDropListDropped)='dropTask($event); element.hidden = false'
         (cdkDropListEntered)='element.hidden = true' (cdkDropListExited)='element.hidden = false'>
      <h2 #element class='no-tasks-message'>
        No tasks
      </h2>
    </div>
    <ng-template #errorMessage>
      <h3 class='no-tasks-message'>
        Error Occurred - refresh page to try again
      </h3>
    </ng-template>
  </ng-template>
</div>
